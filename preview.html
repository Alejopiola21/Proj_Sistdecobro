<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulador de Sistema de Cobro</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F3F4F6;
            color: #1F2937;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">

    <div class="bg-white p-8 rounded-2xl shadow-xl w-full max-w-2xl">
        <h1 class="text-3xl font-bold mb-6 text-center text-gray-800">Sistema de Cobro del Complejo</h1>
        <p class="text-gray-600 text-center mb-8">Busca un miembro por nombre o DNI para ver el estado de su membresía y registrar pagos.</p>

        <!-- Sección de Búsqueda -->
        <div class="flex flex-col md:flex-row gap-4 mb-8">
            <input type="text" id="searchInput" placeholder="Nombre o DNI del miembro" class="flex-grow p-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 transition-all">
            <button id="searchButton" class="bg-blue-600 text-white p-3 rounded-xl font-semibold hover:bg-blue-700 transition-colors shadow-md">Buscar Miembro</button>
        </div>

        <!-- Sección de Resultados -->
        <div id="resultados" class="hidden mb-8">
            <div id="miembroCard" class="p-6 rounded-2xl shadow-md border-2 transition-colors duration-300">
                <h2 id="miembroNombre" class="text-2xl font-bold mb-2"></h2>
                <p id="miembroDNI" class="text-gray-500 mb-4"></p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <p class="font-semibold text-gray-700">Estado de la Cuota:</p>
                        <span id="estadoCuota" class="font-bold text-lg rounded-full px-4 py-1 inline-block mt-1"></span>
                    </div>
                    <div>
                        <p class="font-semibold text-gray-700">Vencimiento:</p>
                        <span id="fechaVencimiento" class="text-md mt-1 block"></span>
                    </div>
                    <div>
                        <p class="font-semibold text-gray-700">Renovación:</p>
                        <span id="fechaRenovacion" class="text-md mt-1 block"></span>
                    </div>
                    <div>
                        <p class="font-semibold text-gray-700">Pagos Mensuales:</p>
                        <span id="pagosMensuales" class="text-md mt-1 block"></span>
                    </div>
                </div>
                <button id="registrarPagoBtn" class="mt-6 w-full md:w-auto bg-green-600 text-white p-3 rounded-xl font-semibold hover:bg-green-700 transition-colors shadow-md">Registrar Pago</button>
            </div>
        </div>

        <!-- Sección para Registrar Nuevo Miembro -->
        <button id="mostrarFormBtn" class="mt-6 w-full bg-gray-200 text-gray-800 p-3 rounded-xl font-semibold hover:bg-gray-300 transition-colors shadow-md">
            Registrar Nuevo Miembro
        </button>

        <div id="formularioNuevoMiembro" class="hidden mt-6 bg-gray-100 p-6 rounded-2xl shadow-inner">
            <h3 class="text-xl font-bold mb-4 text-center">Nuevo Miembro</h3>
            <div class="space-y-4">
                <input type="text" id="nombreNuevo" placeholder="Nombre completo" class="w-full p-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
                <input type="text" id="dniNuevo" placeholder="DNI" class="w-full p-3 rounded-xl border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500">
            </div>
            <button id="registrarNuevoBtn" class="mt-6 w-full bg-blue-600 text-white p-3 rounded-xl font-semibold hover:bg-blue-700 transition-colors shadow-md">Registrar Miembro</button>
        </div>
        
        <!-- Mensajes del Sistema (Modal simple) -->
        <div id="mensaje" class="hidden fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center p-4">
            <div class="bg-white p-6 rounded-2xl shadow-2xl w-full max-w-sm text-center">
                <p id="mensajeTexto" class="text-lg font-semibold mb-4"></p>
                <button id="cerrarMensajeBtn" class="bg-blue-600 text-white px-6 py-2 rounded-xl font-semibold">Aceptar</button>
            </div>
        </div>

    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // 'Base de datos' de miembros en memoria
            let miembrosDB = [
                { id: 1, nombre: 'Juan Pérez', dni: '12345678', fechaRenovacion: '10/07/2024', fechaVencimiento: '10/08/2024', pagosMensuales: 1 },
                { id: 2, nombre: 'Ana Gómez', dni: '87654321', fechaRenovacion: '25/06/2024', fechaVencimiento: '25/07/2024', pagosMensuales: 1 },
                { id: 3, nombre: 'Carlos López', dni: '11223344', fechaRenovacion: '01/08/2024', fechaVencimiento: '01/09/2024', pagosMensuales: 0 }
            ];

            const searchInput = document.getElementById('searchInput');
            const searchButton = document.getElementById('searchButton');
            const resultadosDiv = document.getElementById('resultados');
            const miembroCard = document.getElementById('miembroCard');
            const miembroNombreSpan = document.getElementById('miembroNombre');
            const miembroDNISpan = document.getElementById('miembroDNI');
            const estadoCuotaSpan = document.getElementById('estadoCuota');
            const fechaVencimientoSpan = document.getElementById('fechaVencimiento');
            const fechaRenovacionSpan = document.getElementById('fechaRenovacion');
            const pagosMensualesSpan = document.getElementById('pagosMensuales');
            const registrarPagoBtn = document.getElementById('registrarPagoBtn');
            const mostrarFormBtn = document.getElementById('mostrarFormBtn');
            const formularioNuevoMiembro = document.getElementById('formularioNuevoMiembro');
            const nombreNuevoInput = document.getElementById('nombreNuevo');
            const dniNuevoInput = document.getElementById('dniNuevo');
            const registrarNuevoBtn = document.getElementById('registrarNuevoBtn');
            const mensajeDiv = document.getElementById('mensaje');
            const mensajeTexto = document.getElementById('mensajeTexto');
            const cerrarMensajeBtn = document.getElementById('cerrarMensajeBtn');

            let miembroActual = null;

            const mostrarMensaje = (texto) => {
                mensajeTexto.textContent = texto;
                mensajeDiv.classList.remove('hidden');
            };

            cerrarMensajeBtn.addEventListener('click', () => {
                mensajeDiv.classList.add('hidden');
            });

            const actualizarVistaMiembro = (miembro) => {
                miembroCard.classList.remove('border-red-500', 'border-green-500');
                estadoCuotaSpan.classList.remove('bg-green-100', 'text-green-800', 'bg-red-100', 'text-red-800');

                const hoy = new Date();
                const vencimiento = new Date(miembro.fechaVencimiento.split('/').reverse().join('-'));

                const estado = hoy > vencimiento ? 'Vencida' : 'Al día';

                miembroNombreSpan.textContent = miembro.nombre;
                miembroDNISpan.textContent = `DNI: ${miembro.dni}`;
                estadoCuotaSpan.textContent = estado;
                fechaVencimientoSpan.textContent = miembro.fechaVencimiento;
                fechaRenovacionSpan.textContent = miembro.fechaRenovacion;
                pagosMensualesSpan.textContent = miembro.pagosMensuales;
                
                if (estado === 'Al día') {
                    miembroCard.classList.add('border-green-500');
                    estadoCuotaSpan.classList.add('bg-green-100', 'text-green-800');
                } else {
                    miembroCard.classList.add('border-red-500');
                    estadoCuotaSpan.classList.add('bg-red-100', 'text-red-800');
                }

                resultadosDiv.classList.remove('hidden');
            };

            const buscarMiembro = () => {
                const query = searchInput.value.toLowerCase().trim();
                miembroActual = miembrosDB.find(m => m.nombre.toLowerCase().includes(query) || m.dni === query);

                if (miembroActual) {
                    actualizarVistaMiembro(miembroActual);
                } else {
                    resultadosDiv.classList.add('hidden');
                    mostrarMensaje('Miembro no encontrado. Intenta de nuevo.');
                }
            };

            searchButton.addEventListener('click', buscarMiembro);
            searchInput.addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    buscarMiembro();
                }
            });

            registrarPagoBtn.addEventListener('click', () => {
                if (miembroActual) {
                    miembroActual.pagosMensuales++;
                    const vencimientoDate = new Date(miembroActual.fechaVencimiento.split('/').reverse().join('-'));
                    vencimientoDate.setMonth(vencimientoDate.getMonth() + 1);
                    miembroActual.fechaVencimiento = `${String(vencimientoDate.getDate()).padStart(2, '0')}/${String(vencimientoDate.getMonth() + 1).padStart(2, '0')}/${vencimientoDate.getFullYear()}`;
                    
                    actualizarVistaMiembro(miembroActual);
                    mostrarMensaje('¡Pago registrado con éxito!');
                }
            });

            mostrarFormBtn.addEventListener('click', () => {
                formularioNuevoMiembro.classList.toggle('hidden');
            });

            registrarNuevoBtn.addEventListener('click', () => {
                const nombre = nombreNuevoInput.value.trim();
                const dni = dniNuevoInput.value.trim();

                if (nombre && dni) {
                    const nuevoMiembro = {
                        id: miembrosDB.length + 1,
                        nombre: nombre,
                        dni: dni,
                        fechaRenovacion: new Date().toLocaleDateString('es-ES', { day: '2-digit', month: '2-digit', year: 'numeric' }),
                        fechaVencimiento: new Date(new Date().setMonth(new Date().getMonth() + 1)).toLocaleDateString('es-ES', { day: '2-digit', month: '2-digit', year: 'numeric' }),
                        pagosMensuales: 0
                    };
                    miembrosDB.push(nuevoMiembro);
                    nombreNuevoInput.value = '';
                    dniNuevoInput.value = '';
                    formularioNuevoMiembro.classList.add('hidden');
                    mostrarMensaje(`¡Miembro '${nombre}' registrado con éxito!`);
                } else {
                    mostrarMensaje('Por favor, completa todos los campos.');
                }
            });
        });
    </script>
</body>
</html>
